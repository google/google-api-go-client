{
  "comments": [
    {
      "key": {
        "uuid": "d59c3e76_944aea90",
        "filename": "google-api-go-generator/gen.go",
        "patchSetId": 8
      },
      "lineNbr": 1656,
      "author": {
        "id": 5505
      },
      "writtenOn": "2015-10-06T00:49:49Z",
      "side": 1,
      "message": "Shouldn\u0027t this be a header, rather than a url arg?",
      "range": {
        "startLine": 1656,
        "startChar": 2,
        "endLine": 1656,
        "endChar": 47
      },
      "revId": "af4fb3d492810c2c8a1ad6476a57164d886a7eb9",
      "serverId": "c958e1eb-c711-3e17-a1d0-c94d35b2e5aa",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0b7078c2_88fa1fa7",
        "filename": "google-api-go-generator/gen.go",
        "patchSetId": 8
      },
      "lineNbr": 1656,
      "author": {
        "id": 5155
      },
      "writtenOn": "2015-10-06T03:07:04Z",
      "side": 1,
      "message": "Yikes!  I\u0027m really sorry about that.\nYes, thank you for catching this!\nI\u0027ll fix it.",
      "parentUuid": "d59c3e76_944aea90",
      "range": {
        "startLine": 1656,
        "startChar": 2,
        "endLine": 1656,
        "endChar": 47
      },
      "revId": "af4fb3d492810c2c8a1ad6476a57164d886a7eb9",
      "serverId": "c958e1eb-c711-3e17-a1d0-c94d35b2e5aa",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d59c3e76_54ba42a3",
        "filename": "google-api-go-generator/storage_test.go",
        "patchSetId": 8
      },
      "lineNbr": 335,
      "author": {
        "id": 5505
      },
      "writtenOn": "2015-10-06T04:37:34Z",
      "side": 1,
      "message": "it might be nice to include something like \"/uploadURL\" here to make the test more readable further down (the request to \"/\" is a bit cryptic.",
      "range": {
        "startLine": 335,
        "startChar": 20,
        "endLine": 335,
        "endChar": 30
      },
      "revId": "af4fb3d492810c2c8a1ad6476a57164d886a7eb9",
      "serverId": "c958e1eb-c711-3e17-a1d0-c94d35b2e5aa",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d59c3e76_b4752ec2",
        "filename": "google-api-go-generator/storage_test.go",
        "patchSetId": 8
      },
      "lineNbr": 360,
      "author": {
        "id": 5505
      },
      "writtenOn": "2015-10-06T04:37:34Z",
      "side": 1,
      "message": "It takes a little effort to verify that this is doing what I think it\u0027s doing.  I think this would be more readable if you made this \n\nif handler.reqURIs[0] !\u003d \"/b/mybucket/o?alt\u003djson\u0026name\u003dfilename\u0026projection\u003dfull\u0026uploadType\u003dresumable\" {...}\n\nand in ServeHTTP, above, process the request url to strip everything but the path and query before storing it in reqURIs.\n\nLooking into this, I see that below, the second request received is simply \"/\" (without a schema, host, port).\n\nThe difference seems to be due to the fact that \n  (c *ObjectsInsertCall) doRequest\ncalls googleapi.Expand which sets the Opaque field of the URL in the http request.  This causes the url in the http request to include the full url, not just the part starting with the path.\n\nYou can canonicalize the incoming urls before storing them in reqURIs by doing:\n\nurl.ParseRequestURI(r.URL.RequestURI()).\n\n\nOnce you are storing both urls in a standard from, this test could be simplified further by just replacing lines 357..365 with\n\nwant :\u003d []string{}{\n  \"/b/mybucket/o?alt\u003djson\u0026name\u003dfilename\u0026projection\u003dfull\u0026uploadType\u003dresumable\",\n  \"/\",\n}\nif handler.reqURIs !\u003d want {\n  t.Fatalf(\"reqURIs: got \u003d %v, want \u003d %v\", handler.reqURIs, want)\n}\n\n\nI think checking all URIs at once like this is clearer than first checking len(handler.reqURIs), and then a separate check for each item in the slice.",
      "range": {
        "startLine": 360,
        "startChar": 12,
        "endLine": 360,
        "endChar": 55
      },
      "revId": "af4fb3d492810c2c8a1ad6476a57164d886a7eb9",
      "serverId": "c958e1eb-c711-3e17-a1d0-c94d35b2e5aa",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d59c3e76_7484a600",
        "filename": "google-api-go-generator/storage_test.go",
        "patchSetId": 8
      },
      "lineNbr": 382,
      "author": {
        "id": 5505
      },
      "writtenOn": "2015-10-06T04:37:34Z",
      "side": 1,
      "message": "two is probably enough.",
      "range": {
        "startLine": 382,
        "startChar": 38,
        "endLine": 382,
        "endChar": 48
      },
      "revId": "af4fb3d492810c2c8a1ad6476a57164d886a7eb9",
      "serverId": "c958e1eb-c711-3e17-a1d0-c94d35b2e5aa",
      "unresolved": false
    }
  ]
}